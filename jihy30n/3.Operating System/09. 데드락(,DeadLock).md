# 🔒 데드락 (DeadLock, 교착 상태)

## 개념
두 개 이상의 프로세스나 스레드가 서로 자원을 얻지 못해 다음 처리를 하지 못하는 상태.  
시스템적으로 한정된 자원을 여러 곳에서 사용하려고 할 때 발생한다.  
예시로, 외나무다리 양 끝에서 두 사람이 서로 비켜주길 기다리는 상황과 비슷하다.

## 발생 사례
![image](https://github.com/user-attachments/assets/4a97a320-1ee8-4dfb-a6d4-63309af17732)

1. 프로세스1이 자원1을, 프로세스2가 자원2를 점유
2. 프로세스1은 자원2를, 프로세스2는 자원1을 요청
3. 서로 상대방의 자원을 기다리며 무한정 대기 → Deadlock 발생

> 멀티 프로그래밍 환경에서 한정된 자원을 얻기 위해 서로 경쟁하는 상황 발생
> 한 프로세스가 자원을 요청했을 때, 동시에 그 자원을 사용할 수 없는 상황이 발생할 수 있음. 이때 프로세스는 대기 상태로 들어감
> 대기 상태로 들어간 프로세스들이 실행 상태로 변경될 수 없을 때 '교착 상태' 발생

## 데드락 발생 조건 (4가지 모두 만족해야 발생)
- **상호 배제 (Mutual Exclusion)**: 자원은 한 번에 한 프로세스만 사용 가능
- **점유 대기 (Hold and Wait)**: 자원을 점유한 상태에서 다른 자원을 기다림
- **비선점 (No Preemption)**: 다른 프로세스가 점유한 자원을 강제로 빼앗을 수 없음
- **순환 대기 (Circular Wait)**: 프로세스 간 자원 요청이 순환 구조를 이룸

## 데드락 처리 방법

### 1. 예방 (Prevention)
데드락 발생 조건 중 하나를 아예 없애는 방식. 자원 낭비가 심하다.
- 상호배제 제거: 자원 공유
- 점유대기 제거: 모든 자원을 시작 전에 할당
- 비선점 제거: 자원 요청 시 기존 자원 반납
- 순환대기 제거: 자원 번호 매기고 순서대로 요청

### 2. 회피 (Avoidance)
발생 가능성은 있지만 시스템이 사전에 회피
- **은행원 알고리즘 (Banker's Algorithm)**  
  고객(프로세스) 요청을 수용할 수 있는지 판단 후 안정 상태면 자원 할당  
  불안정하면 대기시키고 자원 해지 기다림

### 3. 탐지 및 회복 (Detection & Recovery)
발생을 허용하고, 탐지 후 회복
- **탐지**: 자원 할당 그래프 등으로 상태 감지
- **회복 방법**
  - 프로세스 종료: 교착 상태 프로세스를 모두 중단하거나 하나씩 중단
  - 자원 선점: 낮은 우선순위 또는 덜 사용된 프로세스의 자원을 빼앗음

## 철학자 문제 (Dining Philosophers Problem)
기아 상태 또는 데드락의 대표 사례
- 해결책:
  - n명 자리 테이블에 철학자 n-1명만 앉힘
  - 젓가락 2개를 동시에 집을 수 있는 경우에만 집도록 함
  - 누군가는 왼쪽이 아닌 오른쪽 젓가락부터 먼저 집도록 함

## 주요 질문
- 데드락(교착 상태)란? 발생 조건은?
- 은행원 알고리즘은 무엇인가요?
- 식사하는 철학자 문제는 무엇인가요?
- 교착 상태 해결책은 어떤 게 있는가?
