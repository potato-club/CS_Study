# 프로세스와 스레드

## 1. 기본 개념

- **프로세스(Process)**: 프로그램이 메모리 상에서 실행 중인 작업 단위
- **스레드(Thread)**: 하나의 프로세스 안에서 실행되는 여러 흐름 단위

> 기본적으로 하나의 프로세스는 최소 1개의 스레드(메인 스레드)를 포함함

---

## 2. 프로세스와 스레드의 메모리 구조 차이

### 프로세스
- 각각 **독립된 주소 공간**을 가짐
- 주요 메모리 영역:
  - **Code**: 프로그램의 명령어를 저장하는 영역
  - **Data**
    - 초기화된 데이터: `.data` 영역
    - 초기화되지 않은 데이터: `.bss` 영역
  - **Heap**: 동적 메모리 할당 영역 (`malloc()`, `new()` 등)
  - **Stack**: 지역 변수, 매개 변수, 리턴 값 등 임시 데이터를 저장

### 스레드
- 같은 프로세스 내에서 **Heap, Data, Code 영역을 공유**
- 단, **Stack은 각 스레드별로 개별 할당**

> 하나의 프로세스가 생성될 때, 기본적으로 하나의 스레드도 함께 생성됨

---

## 3. 멀티프로세스

### 정의
- 하나의 프로그램을 여러 개의 **프로세스**로 구성하여 병렬 처리하는 방식

### 장점
- **안정성**: 프로세스 간 메모리 영역이 분리되어 있어, 메모리 침범 시 OS 차원에서 보호 가능

### 단점
- 독립된 메모리 공간 사용으로 인해 **오버헤드 발생**
- **Context Switching**에 따른 성능 저하 가능성

### Context Switching이란?
- 프로세스 상태 정보를 저장하고 복원하는 과정
- 프로세스 전환 시 캐시 메모리 초기화 등으로 **비용이 큰 작업**이 수행됨

---

## 4. 멀티스레드

### 정의
- 하나의 응용 프로그램 안에서 여러 **스레드**가 각기 다른 작업을 병렬적으로 수행

### 장점
- 메모리 공간을 **공유**하기 때문에 자원 사용 효율적
- **전역 변수, 정적 변수** 공유 가능
- Context Switching 비용이 낮음

### 단점
- **안정성 문제** 존재: 하나의 스레드가 공유 자원에 오류를 일으키면 전체 프로세스에 영향

---

## 5. 스레드 안전성과 동기화

### Critical Section(임계 구역)
- 공유 자원에 여러 스레드가 동시에 접근할 때 발생할 수 있는 문제를 방지하기 위한 **동기화 기법**

### 해결 조건
1. **상호 배제(Mutual Exclusion)**: 하나의 스레드만 임계 구역에 접근 가능
2. **진행(Progress)**: 임계 구역에 접근할 스레드가 없다면 즉시 다음 실행 결정 가능
3. **한정된 대기(Bounded Waiting)**: 임계 구역에 들어가기 위한 대기 시간이 제한됨

---

## 정리

| 항목          | 프로세스                        | 스레드                          |
|---------------|----------------------------------|----------------------------------|
| 주소 공간     | 독립적                          | 공유                             |
| 메모리 사용   | 별도 공간 (Code, Data, Heap 등) | Stack만 개별, 나머지 공유        |
| 생성 비용     | 상대적으로 큼                   | 상대적으로 작음                 |
| 안정성        | 높음 (OS 보호)                  | 낮음 (공유로 인한 충돌 가능)    |
| 주요 활용 예  | 브라우저, 멀티탭 앱 등          | 웹 서버, 병렬 처리 앱 등  


---
# 질문
- 하나의 프로세스 내 여러 스레드가 Stack 영역만 개별적으로 갖는 이유는?
→ 함수 호출과 지역 변수 처리를 독립적으로 하기 위해서

- 멀티프로세스 방식보다 멀티스레드 방식이 자원 소모가 적은 주된 이유는?
  -> 메모리 공간을 공유하기 때문

- Context Switching이 자주 일어나면 성능이 저하되는 주된 이유는
-> 프로세스 상태 저장과 복원이 비용이 크기 때문
