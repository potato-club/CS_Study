# TCP μ—°κ²° κ³Όμ • μ •λ¦¬

TCP(Transmission Control Protocol)λ” **μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅**μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ μ—°κ²° μ§€ν–¥ λ°©μ‹(connection-oriented)μ„ μ‚¬μ©ν•¨

λ”°λΌμ„ ν†µμ‹ μ„ μ‹μ‘ν•  λ•λ” **3-way handshake**, ν†µμ‹ μ΄ λλ‚ ν›„μ—λ” **4-way handshake** κ³Όμ •μ„ ν†µν•΄ μ—°κ²°μ„ μ„¤μ •ν•κ³  ν•΄μ ν•¨

---

## π”— 1. 3-Way Handshake (μ—°κ²° μ„±λ¦½)

> ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„ **λ…Όλ¦¬μ μΈ μ—°κ²°**μ„ μ„¤μ •ν•λ” κ³Όμ •

1. **SYN**  
   ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„  
   ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²° μ”μ²­μ„ λ³΄λƒ„  
   - ν”λκ·Έ: `SYN`
   - `SEQ = x` (ν΄λΌμ΄μ–ΈνΈ μ΄κΈ° μ‹ν€€μ¤ λ²νΈ)

2. **SYN-ACK**  
   μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ  
   μ„λ²„κ°€ μ—°κ²° μ”μ²­μ„ μλ½ν•κ³ , λ™μ‹μ— μ„λ²„λ„ μ—°κ²° μ”μ²­μ„ λ³΄λƒ„  
   - ν”λκ·Έ: `SYN, ACK`
   - `SEQ = y`, `ACK = x + 1`

3. **ACK**  
   ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„  
   ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ μ‘λ‹µμ„ μλ½ν•¨  
   - ν”λκ·Έ: `ACK`
   - `ACK = y + 1`

β” μ΄ κ³Όμ •μ„ ν†µν•΄ μ–‘μ½ λ¨λ‘ μ‹ν€€μ¤ λ²νΈ(SEQ)μ™€ ν™•μΈ μ‘λ‹µ λ²νΈ(ACK)λ¥Ό μ„¤μ •ν•λ©°, μ—°κ²° μƒνƒ(ESTABLISHED)λ΅ μ§„μ…

> μ΄λ¦„μ΄ 3-wayμΈ μ΄μ λ” **SYN β†’ SYN-ACK β†’ ACK** 3λ‹¨κ³„λ΅ μ΄λ£¨μ–΄μ§€κΈ° λ•λ¬Έ

---

## π” 2. 4-Way Handshake (μ—°κ²° ν•΄μ )

> ν΄λΌμ΄μ–ΈνΈ λλ” μ„λ²„κ°€ λ¨Όμ € μ—°κ²°μ„ μΆ…λ£ν•  μ μμΌλ©°, **μ–‘λ°©ν–¥ μΆ…λ£**λ¥Ό μ„ν•΄ 4λ‹¨κ³„κ°€ ν•„μ”

1. **FIN (ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„)**  
   ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²° μΆ…λ£ μ”μ²­  
   - ν”λκ·Έ: `FIN`
   - ν΄λΌμ΄μ–ΈνΈλ” `FIN_WAIT_1` μƒνƒλ΅ μ§„μ…

2. **ACK (μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ)**  
   μ„λ²„κ°€ FIN μ”μ²­μ„ μμ‹  ν™•μΈ  
   - ν”λκ·Έ: `ACK`
   - μ„λ²„λ” `CLOSE_WAIT` μƒνƒλ΅ μ „ν™
   - ν΄λΌμ΄μ–ΈνΈλ” `FIN_WAIT_2` μƒνƒ

3. **FIN (μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ)**  
   μ„λ²„λ„ μ—°κ²° μΆ…λ£λ¥Ό μ”μ²­  
   - ν”λκ·Έ: `FIN`
   - μ„λ²„λ” `LAST_ACK` μƒνƒ

4. **ACK (ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„)**  
   ν΄λΌμ΄μ–ΈνΈκ°€ μΆ…λ£ μ”μ²­μ„ ν™•μΈ  
   - ν”λκ·Έ: `ACK`
   - ν΄λΌμ΄μ–ΈνΈλ” `TIME_WAIT` μƒνƒμ—μ„ μΌμ • μ‹κ°„ λ€κΈ° ν›„ μ—°κ²° μΆ…λ£

β” μ„λ²„λ” `ACK`λ¥Ό λ°›μ€ ν›„ `CLOSED` μƒνƒλ΅ μ „ν™  
β” ν΄λΌμ΄μ–ΈνΈλ” **μ¬μ „μ†΅ λ°©μ§€ λ° λ°μ΄ν„° μ μ‹¤ λ°©μ§€**λ¥Ό μ„ν•΄ TIME_WAIT μƒνƒ μ μ§€ ν›„ `CLOSED`

---

## π“ μƒνƒ μ”μ•½

| ν΄λΌμ΄μ–ΈνΈ μƒνƒ       | μ„λ²„ μƒνƒ         |
|--------------------|------------------|
| FIN_WAIT_1         | ESTABLISHED      |
| FIN_WAIT_2         | CLOSE_WAIT       |
| TIME_WAIT          | LAST_ACK         |
| CLOSED             | CLOSED           |

---
- **TIME_WAIT**: ν¨ν‚·μ μ§€μ—° λ„μ°©μ— λ€λΉ„ν•μ—¬ κΈ°λ‹¤λ¦¬λ” μ‹κ°„ (κΈ°λ³Έ 2 * MSL)
- **MSL (Maximum Segment Lifetime)**: ν¨ν‚·μ΄ λ„¤νΈμ›ν¬ μƒμ— λ¨Έλ¬Ό μ μλ” μµλ€ μ‹κ°„
- **QUIC**: Googleμ΄ κ°λ°ν• μƒλ΅μ΄ μ „μ†΅ ν”„λ΅ν† μ½λ΅, 3-way handshake μ—†μ΄ λΉ λ¥΄κ² μ—°κ²°

---


